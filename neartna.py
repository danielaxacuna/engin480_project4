# Neart Na Gaoithe 

# Imports
import numpy as np
import pyproj
from py_wake.site import UniformWeibullSite
from py_wake.wind_turbines import OneTypeWindTurbines
from py_wake.literature.gaussian_models import Bastankhah_PorteAgel_2014
from py_wake.wind_turbines.generic_wind_turbines import GenericWindTurbine


# Define turbine positions
utm_turbines = np.array([
 
    [56.2361806534725, -2.298472336992006],
    [56.24953469454593, -2.288720157792966],
    [56.23521278837666, -2.2726987205383296],
    [56.228049826558106, -2.2643397097973548],
    [56.22766260127864, -2.288023573564743],
    [56.220498227718394, -2.278967978594693],
    [56.21333251467095, -2.2702606757387684],
    [56.21352620020423, -2.2497114409991354],
    [56.23521278837666, -2.2507563173422795],
    [56.235987082409906, -2.2309036668308693],
    [56.22863065713915, -2.2235895324321575],
    [56.21410725093327, -2.2072198030634524],
    [56.21352620020423, -2.1870188604379166],
    [56.24585795943324, -2.2019954213502047],
    [56.23918087985675, -2.1948554330074046],
    [56.239761541689234, -2.1736096140395773],
    [56.22504872828469, -2.159329637356336],
    [56.21342935756036, -2.165250603298574],
    [56.25369478478518, -2.2098319939197495],
    [56.25504913521581, -2.1896310512941852],
    [56.25524260993686, -2.167340355983214],
    [56.267429545932316, -2.2453577895716705],
    [56.2772923183519, -2.212270038719282],
    [56.284639397535415, -2.2195841731179655],
    [56.29527082792853, -2.2084388254624514],
    [56.280966034397835, -2.2610309347113287],
    [56.26955702567028, -2.204259320092376],
    [56.28676592016288, -2.2004281068355738],
    [56.27922589710545, -2.192417388207872],
    [56.2709108148149, -2.1840583774668687],
    [56.26278736128572, -2.1750027824968186],
    [56.29353134164907, -2.332082526014375],
    [56.30995666642346, -2.3108367070465192],
    [56.30222798138436, -2.302477696305516],
    [56.285219369982485, -2.3254649758447385],
    [56.27477851981462, -2.333475694471616],
    [56.25833807247551, -2.324071807387469],
    [56.25253387484656, -2.310488414932422],
    [56.24421298993943, -2.3080503701328894],
    [56.26452824653086, -2.2833216300223],
    [56.266075633589935, -2.264862147968131],
    [56.27883918917581, -2.2976016067056264],
    [56.27265133046089, -2.27252457448094],
    [56.289858832844345, -2.249537294941746],
    [56.28579933363133, -2.3049157411051056],
    [56.28850571433682, -2.2673001927677205],
    [56.29759001981756, -2.2582445977976704],
    [56.312854520219304, -2.276007495623645],
    [56.33217915200274, -2.247065203304004],
    [56.32503433210442, -2.2387061925621765],
    [56.31402483006889, -2.2501998323317878],
    [56.31750185786635, -2.231043766049396],
    [56.309581500503555, -2.223729631650741],
    [56.30204597763864, -2.2153706209088853]

])




# Transform geographic coordinates to UTM using pyproj
transformer = pyproj.Transformer.from_crs("epsg:4326", "epsg:32619", always_xy=True)
x, y = transformer.transform(utm_turbines[:,1], utm_turbines[:,0])



class Neart_na_Gaoithe(UniformWeibullSite):
    def __init__(self, ti=0.07, shear=None):
        

        f = [8.63, 9.35, 11.52, 10.57, 9.10, 9.82, 9.10, 9.85, 11.74, 9.86, 9.76, 8.50]
        a = [9.85, 10.20, 11.25, 10.89, 10.36, 10.56, 11.52, 11.86, 12.26, 11.24, 11.13, 10.20]
        k = [2.564, 2.935, 2.836, 2.625, 2.476, 2.709, 2.745, 2.932, 3.226, 2.875, 2.869, 2.600]


        UniformWeibullSite.__init__(self, np.array(f) / np.sum(f), a, k, ti=ti, shear=shear)
        #self.initial_position = np.array([xinit, yinit]).T
        self.name = "Neart_na_Gaoithe"


# site = UniformWeibullSite(p_wd=p_wd, a=weibull_A, k=weibull_k, ti=0.1)

site = Neart_na_Gaoithe()

class SG_8_167_DD(GenericWindTurbine):


    def __init__(self):
        """
        Parameters
        ----------
        The turbulence intensity Varies around 6-8%
        Hub Height Site Specific
        """
        #power norm in kW
        GenericWindTurbine.__init__(self, name='SG_8_167_DD', diameter=167, hub_height=115,
                             power_norm=13000, turbulence_intensity=0.08)


wind_turbines = SG_8_167_DD()


wf_model = Bastankhah_PorteAgel_2014(site, windTurbines=wind_turbines, k=0.0324555)


#aep = wf_model.aep().sum()
aep = wf_model.aep(x, y).sum()


#print('AEP:', aep)
print('AEP:', aep)
